{% extends "base.html" %}
{% block title %}Новый пароль — WOOM FIT{% endblock %}
{% block topbar_left %}
  <a class="btn btn--ghost" style="padding:8px 10px; border-radius:14px;" href="{% url 'login' %}">←</a>
{% endblock %}
{% block content %}
  <h2 class="section-title">Новый пароль</h2>

  {% if validlink %}
    <form method="post" class="card">
      {% csrf_token %}
      {% if form.non_field_errors %}
        <div class="muted" style="font-weight:900; color:#973e3e; margin-bottom:8px;">
          {% for error in form.non_field_errors %}{{ error }}{% if not forloop.last %}<br>{% endif %}{% endfor %}
        </div>
      {% endif %}

      <div class="list">
        <div>
          <label class="muted" style="font-weight:900;">Новый пароль</label>
          {{ form.new_password1 }}
          {% if form.new_password1.help_text %}
            <div class="muted" style="font-weight:700; margin-top:6px;">
              {{ form.new_password1.help_text|safe }}
            </div>
          {% endif %}
          {% if form.new_password1.errors %}
            <div class="muted" style="font-weight:900; color:#973e3e; margin-top:4px;">
              {% for error in form.new_password1.errors %}{{ error }}{% if not forloop.last %}<br>{% endif %}{% endfor %}
            </div>
          {% endif %}
        </div>
        <div>
          <label class="muted" style="font-weight:900;">Повтор нового пароля</label>
          {{ form.new_password2 }}
          {% if form.new_password2.errors %}
            <div class="muted" style="font-weight:900; color:#973e3e; margin-top:4px;">
              {% for error in form.new_password2.errors %}{{ error }}{% if not forloop.last %}<br>{% endif %}{% endfor %}
            </div>
          {% endif %}
        </div>
      </div>

      <div style="margin-top:14px;">
        <button class="btn btn--primary btn--full" type="submit">Сохранить новый пароль</button>
      </div>
    </form>
  {% else %}
    <div class="card">
      <div class="muted" style="font-weight:800;">
        Ссылка восстановления недействительна или уже использована.
      </div>
      <div style="margin-top:14px;">
        <a class="btn btn--ghost btn--full" href="{% url 'accounts:password_reset_request' %}">Запросить новую ссылку</a>
      </div>
    </div>
  {% endif %}
{% endblock %}
